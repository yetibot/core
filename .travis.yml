language: clojure
lein: lein
jdk:
  - oraclejdk8
  - oraclejdk9
  - oraclejdk11

before_script:
  - psql -c 'create database yetibot;' -U postgres

env:
  - YETIBOT_DB_URL="postgresql://postgres@localhost:5432/yetibot"

deploy:
  provider: script
  script:
  - git status
  - git checkout package-lock.json # ignore changes from npm
  - git status
  - echo "Releasing..."
  - lein release
  # TODO switch this to master
  on:
    branch: derived-version

services:
  - postgresql
